!function(s,n,p,_,l,v,o,u,b,g){p(n).ready(function(){var e=v.get_url_param("tribe_paged"),a=p("#tribe-events > .tribe-events-venue");if(e&&(o.paged=e),u.pushstate&&!u.map_view()){var t="action=tribe_list&tribe_paged="+o.paged;_.params.length&&(t=t+"&"+_.params),o.category&&(t=t+"&tribe_event_category="+o.category),v.is_featured()&&(t+="&featured=1"),history.replaceState({tribe_params:t,tribe_url_params:_.params},n.title,location.href),p(s).on("popstate",function(e){var t=e.originalEvent.state;t&&!a.length&&(o.do_string=!1,o.pushstate=!1,o.popping=!0,o.params=t.tribe_params,o.url_params=t.tribe_url_params,v.pre_ajax(function(){i()}),v.set_form(o.params))})}function r(e){if("change_view"!=tribe_events_bar_action){if(e.preventDefault(),o.ajax_running)return;var t=n.location.pathname;if(o.paged=1,t.match(/\/all\/$/))o.view="all";else{var a=tribeUtils.getQueryVars().tribe_event_display;o.view=void 0!==a?a:"list"}o.popping=!1,v.pre_ajax(function(){i()})}}function i(){var e=p("#tribe-events-header");if(o.ajax_running=!0,!o.popping){o.filter_cats&&(_.cur_url=e.data("baseurl"));var t=p("#tribe-events-list-hash").val();if(o.params={action:"tribe_list",tribe_paged:o.paged,tribe_event_display:o.view,featured:v.is_featured()},o.url_params={tribe_paged:o.paged,tribe_event_display:o.view},(n.location.pathname.match(/\/all\/$/)||_.cur_url.match(/tribe_post_parent=[0-9]+/))&&(o.url_params.tribe_event_display="past"===o.url_params.tribe_event_display?"past":"all",o.params.tribe_post_parent=parseInt(e.closest("#tribe-events-content").find("[data-parent-post-id]:first").data("parent-post-id"),10)),""===tribe_js_config.permalink_settings&&(o.url_params.eventDisplay="all"===o.url_params.tribe_event_display?"all":"list"),t.length&&(o.params.hash=t),_.default_permalinks&&!o.url_params.hasOwnProperty("post_type")&&(o.url_params.post_type=b.events_post_type),o.category&&(o.params.tribe_event_category=o.category),p(l).trigger("tribe_ev_serializeBar"),v.invalid_date_in_params(o.params))return void(o.ajax_running=!1);p("#tribe-events-content .tribe-events-loop").tribe_spin(),o.params=p.param(o.params),o.url_params=p.param(o.url_params),p(l).trigger("tribe_ev_collectParams"),o.pushstate=!1,o.do_string=!0}u.pushstate&&!o.filter_cats?(g&&tec_debug.time("List View Ajax Timer"),p(l).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_listView_AjaxStart"),p.post(TribeList.ajaxurl,o.params,function(e){if(o.initial_load=!1,v.enable_inputs("#tribe_events_filters_form","input, select"),e.success){o.ajax_running=!1,_.ajax_response={total_count:parseInt(e.total_count),view:e.view,max_pages:e.max_pages,tribe_paged:e.tribe_paged,timestamp:(new Date).getTime()},p("#tribe-events-list-hash").val(e.hash);var t=p.parseHTML(e.html);p("#tribe-events-content").replaceWith(t),0===e.total_count&&p("#tribe-events-header .tribe-events-sub-nav").empty(),o.page_title=p("#tribe-events-header").data("title"),o.view_title=p("#tribe-events-header").data("viewtitle"),n.title=o.page_title,p(".tribe-events-page-title").html(o.view_title),o.do_string&&history.pushState({tribe_params:o.params,tribe_url_params:o.url_params},o.page_title,_.cur_url+"?"+o.url_params),o.pushstate&&history.pushState({tribe_params:o.params,tribe_url_params:o.url_params},o.page_title,_.cur_url),p(l).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_listView_AjaxSuccess"),p(l).trigger("ajax-success.tribe").trigger("tribe_ev_listView_AjaxSuccess"),g&&tec_debug.timeEnd("List View Ajax Timer")}})):o.url_params.length?s.location=_.cur_url+"?"+o.url_params:s.location=_.cur_url}p("#tribe-events-content-wrapper,.tribe-events-view-wrapper").on("click",'ul.tribe-events-sub-nav a[rel="next"]',function(e){if(e.preventDefault(),!o.ajax_running){var t=p(this).attr("href"),a=/tribe_event_display=([^&]+)/gi,r=a.exec(t);p(this).parent().is(".tribe-events-past")?o.view="past":r&&void 0!==r[1]?o.view=r[1]:o.view="list",_.cur_url=v.url_path(t),(r=(a=/tribe_paged=([^&]+)/gi).exec(t))&&void 0!==r[1]?o.paged=r[1]:"list"===o.view?o.paged?o.paged++:o.paged=2:o.paged?o.paged--:(o.view="list",o.paged=1),o.popping=!1,v.pre_ajax(function(){i()})}}).on("click",'ul.tribe-events-sub-nav a[rel="prev"]',function(e){if(e.preventDefault(),!o.ajax_running){var t=p(this).attr("href"),a=/tribe_event_display=([^&]+)/gi,r=a.exec(t);p(this).parent().is(".tribe-events-past")?o.view="past":r&&void 0!==r[1]?o.view=r[1]:o.view="list",r=(a=/tribe_paged=([^&]+)/gi).exec(t),_.cur_url=v.url_path(p(this).attr("href")),r&&void 0!==r[1]?o.paged=r[1]:"list"===o.view?1<o.paged?o.paged--:(o.paged=1,o.view="past"):o.paged++,o.popping=!1,v.pre_ajax(function(){i()})}}),p("#tribe-events.tribe-events-shortcode").length?v.snap("#tribe-events","#tribe-events","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a"):v.snap("#tribe-events-content-wrapper","#tribe-events-content-wrapper","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a"),(u.no_bar()||u.live_ajax()&&u.pushstate)&&p("#tribe-events-bar").on("changeDate","#tribe-bar-date",function(e){u.reset_on()||(o.popping=!1,r(e))}),p("form#tribe-bar-form").on("submit",function(e){o.popping=!1,r(e)}),p(l).on("tribe_ev_runAjax",function(){i()}),g&&tec_debug.info("TEC Debug: tribe-events-ajax-list.js successfully loaded"),o.view&&g&&tec_debug.timeEnd("Tribe JS Init Timer")})}(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_js_config,tribe_debug);