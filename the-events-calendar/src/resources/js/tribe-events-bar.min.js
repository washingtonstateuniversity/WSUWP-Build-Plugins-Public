var tribe_events_bar_action;!function(w,_,C,k,y,D,x,B,E){C(_).ready(function(){E&&(C().bootstrapDatepicker||tec_debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-events-bar.js"),C().placeholder||tec_debug.warn("TEC Debug: vendor placeholder was not loaded before its dependant file tribe-events-bar.js"));var i=C(_.getElementById("tribe-bar-form")),r=C(_.getElementById("tribe-bar-date")),e=(C(_.getElementById("tribe-events")),C(_.getElementById("tribe-events-header"))),a=0,t=C("select[name=tribe-bar-view]");function s(e){if(!e.parents(".tribe-bar-disabled").length){var a=e.width();800<a?e.removeClass("tribe-bar-mini tribe-bar-collapse").addClass("tribe-bar-full"):e.removeClass("tribe-bar-full").addClass("tribe-bar-mini"),a<728?(e.removeClass("tribe-bar-mini").addClass("tribe-bar-collapse"),m(C("#tribe-bar-collapse-toggle"))):(e.removeClass("tribe-bar-collapse"),u(C("#tribe-bar-collapse-toggle")))}}if(e.length&&(a=e.data("startofweek")),s(i),i.resize(function(){s(i)}),!C(".tribe-events-week-grid").length&&"month"!==x.view){var n="yyyy-mm-dd";if("0"!==x.datepicker_format){n=k.datepicker_formats.main[x.datepicker_format];var b=D.get_url_param("tribe-bar-date");b?r.val(tribeDateFormat(b,x.datepicker_format)):"day"===x.view&&0!==r.val().length&&r.val(tribeDateFormat(r.val(),x.datepicker_format))}E&&tec_debug.info('TEC Debug: bootstrapDatepicker was just initialized in "tribe-events-bar.js" on:',r),k.datepicker_opts={weekStart:a,format:n,autoclose:!0},tribe_ev.fn.ensure_datepicker_i18n(),r.bootstrapDatepicker(k.datepicker_opts)}r.blur(function(){""===r.val()&&C(".datepicker.dropdown-menu").is(":hidden")&&B.live_ajax()&&B.pushstate&&(x.date=k.cur_date,k.cur_url=k.base_url,C(y).trigger("tribe_ev_runAjax"),C(y).trigger("run-ajax.tribe"))}),C(".tribe-bar-settings").length&&C(_.getElementById("tribe-events-bar")).addClass("tribe-has-settings"),C("#tribe-events-bar .hasDatepicker").length&&C(_.getElementById("tribe-events-bar")).addClass("tribe-has-datepicker"),C('input[name*="tribe-bar-"]').placeholder(),C('<ul class="tribe-bar-views-list" tabindex="-1" role="listbox" aria-labelledby="tribe-bar-views-label" />').insertAfter(t);var l=C(".tribe-bar-views-list");function o(){return l.find("li[data-view="+t.find(":selected").data("view")+"]")}t.find("option").each(function(e){var a=C(this);displaying=a.data("view");var t="tribe-bar-views-option-"+a.data("view");C("<li></li>",{id:t,class:"tribe-bar-views-option",role:"option",tabindex:"-1","data-tribe-bar-order":e,"data-view":displaying,"aria-labelledby":"tribe-bar-views-label "+t}).html('<span class="tribe-icon-'+displaying+'" aria-hidden="true" role="none"></span>'+a.text()).appendTo(".tribe-bar-views-list")});var d=o();d.addClass("tribe-bar-active");var v=C("<button>",{id:"tribe-bar-views-toggle",class:"tribe-bar-views-toggle","data-view":d.data("view"),"aria-haspopup":"listbox","aria-labelledby":"tribe-bar-views-label tribe-bar-views-toggle"});function c(){var e=o();v.removeAttr("aria-expanded"),i.removeClass("tribe-bar-views-open"),l.slideUp("fast").removeAttr("aria-activedescendant").find(".tribe-bar-views-option").removeClass("tribe-bar-active"),e.addClass("tribe-bar-active")}function p(e,a){e.preventDefault();var t=C(a);if(t.data("view")===v.data("view"))return v.focus(),void c();v.html(t.html()).focus(),c(),x.cur_url=C("option[data-view="+t.data("view")+"]").val(),x.view_target=C('select[name=tribe-bar-view] option[value="'+x.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",f()}function u(e){var a=e.attr("data-label-shown");e.attr("aria-expanded","true"),e.find(".tribe-bar-toggle-text").html(a),e.addClass("tribe-bar-filters-open"),C(".tribe-bar-filters").slideDown("fast").attr("aria-hidden","false")}function m(e){var a=e.attr("data-label-hidden");C(".tribe-bar-filters").slideUp("fast").attr("aria-hidden","true"),e.removeClass("tribe-bar-filters-open"),e.find(".tribe-bar-toggle-text").html(a),e.attr("aria-expanded","false")}function f(){if(tribe_events_bar_action="change_view","month"===x.view&&r.length){var e=r.val(),a=D.get_day();"0"!=x.datepicker_format?(e=tribeDateFormat(r.bootstrapDatepicker("getDate"),"tribeMonthQuery"),r.val(e+a)):7===e.length&&r.val(e+a)}x.url_params={},C(y).trigger("tribe_ev_preCollectBarParams"),C(y).trigger("pre-collect-bar-params.tribe"),C(_.getElementById("tribe-bar-form")).add(_.getElementById("tribe_events_filters_wrapper")).find("input, select").each(function(){var e=C(this);e.val()&&e.val().length&&!e.hasClass("tribe-no-param")&&("month"!==x.view&&"0"!==x.datepicker_format&&e.is(r)?x.url_params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery"):e.is(":checkbox")?e.is(":checked")&&(void 0===x.url_params[e.attr("name")]&&(x.url_params[e.attr("name")]=[]),x.url_params[e.attr("name")].push(e.val())):"radio"===e.attr("type")?e.is(":checked")&&(x.url_params[e.attr("name")]=e.val()):void 0!==e.attr("name")&&(x.url_params[e.attr("name")]=e.val()))});var t=C(".tribe-bar-views-option-"+k.default_mobile_view).data("redirected");(k.redirected_view||t)&&(x.url_params.tribe_redirected=!0),x.url_params=C.param(x.url_params),C(y).trigger("tribe_ev_postCollectBarParams"),C(y).trigger("post-collect-bar-params.tribe"),x.url_params.length&&(x.cur_url+=B.starting_delim()+x.url_params),w.location.href=x.cur_url}v.html(d.html()).insertBefore(l),t.hide(),i.on("click","#tribe-bar-views-toggle",function(e){var a;e.preventDefault(),i.hasClass("tribe-bar-views-open")?c():(a=o(),l.slideDown("fast").attr("aria-activedescendant",a.attr("id")).focus(),i.addClass("tribe-bar-views-open"),v.attr("aria-expanded","true"))}),i.on("click",".tribe-bar-views-option",function(e){p(e,this)}),C(_).on("keydown",function(e){if((38===e.which||40===e.which)&&i.hasClass("tribe-bar-views-open")){e.preventDefault();var a=e.which,t=null,r=l.find("li.tribe-bar-active");38===a&&r.prev(".tribe-bar-views-option")&&(t=r.prev(".tribe-bar-views-option")),40===a&&r.next(".tribe-bar-views-option")&&(t=r.next(".tribe-bar-views-option")),t.length&&(l.attr("aria-activedescendant",t.attr("id")),r.removeClass("tribe-bar-active"),t.addClass("tribe-bar-active").focus())}}),i.on("keyup",".tribe-bar-views-option",function(e){13===e.which&&i.hasClass("tribe-bar-views-open")&&p(e,this)}),i.on("change",".tribe-bar-views-select",function(e){e.preventDefault();var a=C("option:selected",this).data("view");x.cur_url=C("option[data-view="+a+"]").val(),x.view_target=C('select[name=tribe-bar-view] option[value="'+x.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",f()}),D.maybe_default_view_change(),i.on("click","#tribe-bar-collapse-toggle",function(e){e.preventDefault();var a=C(this);a.hasClass("tribe-bar-filters-open")?m(a):u(a)}),C(_).on("keyup",function(e){if(9===e.which){var a=C("#tribe-bar-collapse-toggle");i.hasClass("tribe-bar-collapse")&&a.hasClass("tribe-bar-filters-open")&&!C.contains(_.getElementById("tribe-bar-filters-wrap"),e.target)&&m(a);var t=C("#tribe-bar-views-toggle");i.hasClass("tribe-bar-views-open")&&t.not(":focus")&&c()}}),C(_).on("keyup",function(e){if(27===e.which){var a=C("#tribe-bar-collapse-toggle");i.hasClass("tribe-bar-collapse")&&a.hasClass("tribe-bar-filters-open")&&(m(a),a.focus());var t=C("#tribe-bar-views-toggle");i.hasClass("tribe-bar-views-open")&&(c(),t.focus())}}),C(y).on("tribe_ev_serializeBar",function(){var e=C("#tribe-bar-collapse-toggle");i.hasClass("tribe-bar-collapse")&&e.hasClass("tribe-bar-filters-open")&&(m(e),e.focus()),C("form#tribe-bar-form input, form#tribe-bar-form select, #tribeHideRecurrence").each(function(){var e=C(this);if(e.is("#tribe-bar-date")){var a=e.val();a.length?"month"===x.view?(x.params[e.attr("name")]=tribeDateFormat(x.mdate,"tribeMonthQuery"),x.url_params[e.attr("name")]=tribeDateFormat(x.mdate,"tribeMonthQuery")):a.match(/[0-9]{4}-[0-9]{2}/)?x.params[e.attr("name")]=x.url_params[e.attr("name")]=a:(x.params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery"),x.url_params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery")):e.is(".placeholder")&&e.is(".bd-updated")?x.url_params[e.attr("name")]=e.attr("data-oldDate"):x.date=k.cur_date}!e.val().length||e.hasClass("tribe-no-param")||e.is("#tribe-bar-date")||(e.is(":checkbox")?e.is(":checked")&&(x.params[e.attr("name")]=e.val(),"map"!==x.view&&(x.url_params[e.attr("name")]=e.val()),("month"===x.view||"day"===x.view||"week"===x.view||x.recurrence)&&x.pushcount++):(x.params[e.attr("name")]=e.val(),"map"!==x.view&&(x.url_params[e.attr("name")]=e.val()),"month"!==x.view&&"day"!==x.view&&"week"!==x.view||x.pushcount++))})});var h=C('#tribe-events-bar [class^="tribe-bar-button-"]'),g=h.next(".tribe-bar-drop-content");h.click(function(){var e=C(this);return e.toggleClass("open"),e.next(".tribe-bar-drop-content").toggle(),!1}),C(_).click(function(e){i.hasClass("tribe-bar-views-open")&&!C.contains(_.getElementById("tribe-bar-views"),e.target)&&(c(),v.focus());var a=C("#tribe-bar-collapse-toggle");i.hasClass("tribe-bar-collapse")&&a.hasClass("tribe-bar-filters-open")&&!C.contains(_.getElementById("tribe-bar-filters-wrap"),e.target)&&(m(a),a.focus()),h.hasClass("open")&&(h.removeClass("open"),g.hide())}),g.click(function(e){e.stopPropagation()}),E&&tec_debug.info("TEC Debug: tribe-events-bar.js successfully loaded")})}(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);